---
title: | 
  | R Markdown template 
  | MSc in Statistics, Imperial College London
author: 'YOUR CID'
subtitle: ""
output:
  bookdown::pdf_book:
    keep_tex: yes
  bookdown::html_document2:
    toc: yes
    toc_float: yes
    highlight: tango
  html_document:
    toc: yes
    df_print: paged
bibliography: ["2025-26_MSc_Statistics_coursework_Rmarkdown_template.bib"]
link-citations: true
---

<style type="text/css">
h1{
  font-size: 24pt;
}
h2{
  font-size: 18pt;
}
body{
  font-size: 12pt;
}
</style>

```{r setup, include = FALSE, tidy=TRUE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
include_solutions <- TRUE
```
```{r setup2, include=FALSE, tidy=TRUE}
require(rmarkdown)
require(knitr)
require(kableExtra)
# Put any library imports and other preamble here.
```

This Rmarkdown document is intended to provide a basic template that you may use throughout the course, and to introduce you to basic functionality of the open-source bookdown R package for writing Rmarkdown documents [@xie2016bookdown].

Please note:

- Rmarkdown syntax for the title and document style;
- bookdown syntax to label and reference equations;
- bookdown syntax to referencing literate and provide a bib file;
- kable syntax to build clean and clear tables that can be referenced;
- Rmarkdown inline functions to collect and print all code used.

# Sampling from the Cauchy distribution
Some over-arching comments...

**Part a.**  
Your solution begins here. Hint: use the inversion method as described by @graham2013stochastic.
```{r, echo=FALSE}
set.seed(17)

### Question 1a
library("mcmc")
smoking_dat <- read.csv('smoking.csv')
#could/should probably extract the relevant statistics- number of smokers with cancer, number of smokers, number of non smokers with cancer, number of non smokers

Ns <- sum(smoking_dat$cigarettes>0)
Nns <- 36-Ns

Nsc <- sum(smoking_dat$cigarettes>0 & smoking_dat$cancer)
Nnsc <- sum(smoking_dat$cigarettes==0 & smoking_dat$cancer)

log_posterior <- function(p,q){ #will work with log posterior (need to mention this explicitly) as that seems to be a requirement of metrop
  #Uniform prior
  log_post <- Nsc*log(p) + (Ns-Nsc)*log(1-p) + Nnsc*log(q) + (Nns - Nnsc)*log(1-q)
  return (log_post)
}

nsmp <- 100000
params_initial <- c(0.5,0.5) #probably a good place to start

posterior <- metrop(
  obj= log_posterior,
  initial = params_initial,
  nbatch=nsmp,
)




# Sample the posterior using the Metropolis algorithm.

nsmp <- 1000000
params_initial <- c(0, 0, 0)
posterior <- metrop(
  obj = log_posterior, 
  initial = params_initial, 
  nbatch = nsmp, 
  dataset = dataset)

# Extract posterior samples.

posterior_samples <- as.matrix(posterior$batch)

# Calculate posterior mean and covariance.

param_est <- colMeans(posterior_samples)
param_covar <- cov(posterior_samples)

# Print out the parameter estimates and the covariance matrix.

cat("Posterior mean:\n")
param_est
cat("\n")
cat("Posterior covariance matrix:\n")
param_covar




```


**Part b.**   
Your solution begins here.
```{r echo=FALSE}

### Question 1b
# INSERT CODE
```

**Part c.**  
Your solution begins here.

```{r echo=FALSE}

### Question 1c
# INSERT CODE
```


# Code appendix

Rather than re-paste all the code to the appendix, here is a trick which makes the markdown file output all the code (without execution) in the appendix, without any duplication.

Please keep in mind to format the code so that the entire code is clearly visible and does not run into the margins of the pdf version.  

```{r ref.label=knitr::all_labels(), echo = T, eval = F}
```

# References
